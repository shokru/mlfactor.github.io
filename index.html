<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Preface | Machine Learning for Factor Investing</title>
<meta name="author" content="Guillaume Coqueret and Tony Guida">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.2"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/header-attrs-2.8/header-attrs.js"></script><script src="libs/jquery-3.5.1/jquery-3.5.1.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.5.3/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.5.3/bootstrap.bundle.min.js"></script><script src="libs/bs3compat-0.2.3.9000/tabs.js"></script><script src="libs/bs3compat-0.2.3.9000/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><script src="libs/kePrint-0.0.1/kePrint.js"></script><link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet">
<script src="https://cdn.jsdelivr.net/autocomplete.js/0/autocomplete.jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/mark.js@8.11.1/dist/mark.min.js"></script><!-- CSS -->
</head>
  
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-163590570-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-163590570-1');
</script>  
  
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="">Machine Learning for Factor Investing</a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="active" href="index.html">Preface</a></li>
<li class="book-part">Introduction</li>
<li><a class="" href="notdata.html"><span class="header-section-number">1</span> Notations and data</a></li>
<li><a class="" href="intro.html"><span class="header-section-number">2</span> Introduction</a></li>
<li><a class="" href="factor.html"><span class="header-section-number">3</span> Factor investing and asset pricing anomalies</a></li>
<li><a class="" href="Data.html"><span class="header-section-number">4</span> Data preprocessing</a></li>
<li class="book-part">Common supervised algorithms</li>
<li><a class="" href="lasso.html"><span class="header-section-number">5</span> Penalized regressions and sparse hedging for minimum variance portfolios</a></li>
<li><a class="" href="trees.html"><span class="header-section-number">6</span> Tree-based methods</a></li>
<li><a class="" href="NN.html"><span class="header-section-number">7</span> Neural networks</a></li>
<li><a class="" href="svm.html"><span class="header-section-number">8</span> Support vector machines</a></li>
<li><a class="" href="bayes.html"><span class="header-section-number">9</span> Bayesian methods</a></li>
<li class="book-part">From predictions to portfolios</li>
<li><a class="" href="valtune.html"><span class="header-section-number">10</span> Validating and tuning</a></li>
<li><a class="" href="ensemble.html"><span class="header-section-number">11</span> Ensemble models</a></li>
<li><a class="" href="backtest.html"><span class="header-section-number">12</span> Portfolio backtesting</a></li>
<li class="book-part">Further important topics</li>
<li><a class="" href="interp.html"><span class="header-section-number">13</span> Interpretability</a></li>
<li><a class="" href="causality.html"><span class="header-section-number">14</span> Two key concepts: causality and non-stationarity</a></li>
<li><a class="" href="unsup.html"><span class="header-section-number">15</span> Unsupervised learning</a></li>
<li><a class="" href="RL.html"><span class="header-section-number">16</span> Reinforcement learning</a></li>
<li class="book-part">Appendix</li>
<li><a class="" href="data-description.html"><span class="header-section-number">17</span> Data description</a></li>
<li><a class="" href="python.html"><span class="header-section-number">18</span> Python notebooks</a></li>
<li><a class="" href="solutions-to-exercises.html"><span class="header-section-number">19</span> Solutions to exercises</a></li>
</ul>
<div class="book-extra">
          
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><!--bookdown:title:end--><!--bookdown:title:start--><div id="preface" class="section level1 unnumbered">
<h1>Preface<a class="anchor" aria-label="anchor" href="#preface"><i class="fas fa-link"></i></a>
<a class="anchor" aria-label="anchor" href="#preface"><i class="fas fa-link"></i></a>
<a class="anchor" aria-label="anchor" href="#preface"><i class="fas fa-link"></i></a>
</h1>
<style>
.container-fluid main {
max-width: 60rem;
}
</style>
  
<p><img src="images/cover.png" style="width:28%; border:0px solid; margin-right: 20px; margin-left: 20px" align="right"></p>
 
  
  
<nav aria-label="Table of contents"><h3>< Last update: 2023-07-17 ></h3>  


  
    
<p>This book is intended to cover some advanced modelling techniques applied to equity <strong>investment strategies</strong> that are built on <strong>firm characteristics</strong>. The content is threefold. First, we try to simply explain the ideas behind most mainstream machine learning algorithms that are used in equity asset allocation. Second, we mention a wide range of academic references for the readers who wish to push a little further. Finally, we provide hands-on <strong>R</strong> code samples that show how to apply the concepts and tools on a realistic dataset which we share to encourage <strong>reproducibility</strong>.</p>

<p>The printed R version can be bought <a href="https://www.routledge.com/Machine-Learning-for-Factor-Investing/Coqueret-Guida/p/book/9780367545864" target="_blank">on the publisher's website</a> or <a href="https://www.amazon.com/Machine-Learning-Factor-Investing-Mathematics/dp/0367545861/" target="_blank">on Amazon (US)</a>, <a href="https://www.amazon.fr/Machine-Learning-Investing-Guillaume-Coqueret/dp/0367545861/" target="_blank">on Amazon (France)</a> and <a href="https://www.amazon.co.uk/Machine-Learning-Investing-Financial-Mathematics/dp/0367545861/ref=sr_1_2?dchild=1&keywords=coqueret&qid=1587124521&sr=8-2" target="_blank">Amazon (UK)</a>. </p>

  <p>The Python version is forthcoming soon and can be pre-ordered on <a href="https://www.amazon.com/Machine-Learning-Investing-Financial-Mathematics/dp/0367639726/ref=sr_1_1" target="_blank">Amazon (US)</a>. </p>
  
<div id="what-this-book-is-not-about" class="section level2 unnumbered">
  
<h2>What this book is not about<a class="anchor" aria-label="anchor" href="#what-this-book-is-not-about"><i class="fas fa-link"></i></a>
<a class="anchor" aria-label="anchor" href="#what-this-book-is-not-about"><i class="fas fa-link"></i></a>
<a class="anchor" aria-label="anchor" href="#what-this-book-is-not-about"><i class="fas fa-link"></i></a>
</h2>
<p>This book deals with machine learning (ML) tools and their applications in factor investing. Factor investing is a subfield of a large discipline that encompasses asset allocation, quantitative trading and wealth management. Its premise is that differences in the returns of firms can be explained by the characteristics of these firms. Thus, it departs from traditional analyses which rely on price and volume data only, like classical portfolio theory à la <span class="citation"><a href="solutions-to-exercises.html#ref-markowitz1952portfolio" role="doc-biblioref">Markowitz</a> (<a href="solutions-to-exercises.html#ref-markowitz1952portfolio" role="doc-biblioref">1952</a>)</span>, or high frequency trading. For a general and broad treatment of Machine Learning in Finance, we refer to <span class="citation"><a href="solutions-to-exercises.html#ref-dixon2020machine" role="doc-biblioref">Matthew F. Dixon, Halperin, and Bilokon</a> (<a href="solutions-to-exercises.html#ref-dixon2020machine" role="doc-biblioref">2020</a>)</span>.</p>
<p>The topics we discuss are related to other themes that will not be covered in the monograph. These themes include:</p>
<ul>
<li>Applications of ML in <strong>other financial fields</strong>, such as <strong>fraud detection</strong> or <strong>credit scoring</strong>. We refer to <span class="citation"><a href="solutions-to-exercises.html#ref-ngai2011application" role="doc-biblioref">Ngai et al.</a> (<a href="solutions-to-exercises.html#ref-ngai2011application" role="doc-biblioref">2011</a>)</span> and <span class="citation"><a href="solutions-to-exercises.html#ref-baesens2015fraud" role="doc-biblioref">Baesens, Van Vlasselaer, and Verbeke</a> (<a href="solutions-to-exercises.html#ref-baesens2015fraud" role="doc-biblioref">2015</a>)</span> for general purpose fraud detection, to <span class="citation"><a href="solutions-to-exercises.html#ref-bhattacharyya2011data" role="doc-biblioref">Bhattacharyya et al.</a> (<a href="solutions-to-exercises.html#ref-bhattacharyya2011data" role="doc-biblioref">2011</a>)</span> for a focus on credit cards and to <span class="citation"><a href="solutions-to-exercises.html#ref-ravisankar2011detection" role="doc-biblioref">Ravisankar et al.</a> (<a href="solutions-to-exercises.html#ref-ravisankar2011detection" role="doc-biblioref">2011</a>)</span> and <span class="citation"><a href="solutions-to-exercises.html#ref-abbasi2012metafraud" role="doc-biblioref">Abbasi et al.</a> (<a href="solutions-to-exercises.html#ref-abbasi2012metafraud" role="doc-biblioref">2012</a>)</span> for studies on fraudulent financial reporting. On the topic of credit scoring, <span class="citation"><a href="solutions-to-exercises.html#ref-wang2011comparative" role="doc-biblioref">G. Wang et al.</a> (<a href="solutions-to-exercises.html#ref-wang2011comparative" role="doc-biblioref">2011</a>)</span> and <span class="citation"><a href="solutions-to-exercises.html#ref-brown2012experimental" role="doc-biblioref">Brown and Mues</a> (<a href="solutions-to-exercises.html#ref-brown2012experimental" role="doc-biblioref">2012</a>)</span> provide overviews of methods and some empirical results. Also, we do not cover ML algorithms for data sampled at higher (daily or intraday) frequencies (microstructure models, limit order book). The chapter from <span class="citation"><a href="solutions-to-exercises.html#ref-kearns2013machine" role="doc-biblioref">Kearns and Nevmyvaka</a> (<a href="solutions-to-exercises.html#ref-kearns2013machine" role="doc-biblioref">2013</a>)</span> and the recent paper by <span class="citation"><a href="solutions-to-exercises.html#ref-sirignano2019universal" role="doc-biblioref">Sirignano and Cont</a> (<a href="solutions-to-exercises.html#ref-sirignano2019universal" role="doc-biblioref">2019</a>)</span> are good introductions on this topic.<br>
</li>
<li>
<strong>Use cases of alternative datasets</strong> that show how to leverage textual data from social media, satellite imagery, or credit card logs to predict sales, earning reports, and, ultimately, future returns. The literature on this topic is still emerging (see, e.g., <span class="citation"><a href="solutions-to-exercises.html#ref-blank2019using" role="doc-biblioref">Blank, Davis, and Greene</a> (<a href="solutions-to-exercises.html#ref-blank2019using" role="doc-biblioref">2019</a>)</span>, <span class="citation"><a href="solutions-to-exercises.html#ref-jha2019implementing" role="doc-biblioref">Jha</a> (<a href="solutions-to-exercises.html#ref-jha2019implementing" role="doc-biblioref">2019</a>)</span> and <span class="citation"><a href="solutions-to-exercises.html#ref-ke2019predicting" role="doc-biblioref">Z. T. Ke, Kelly, and Xiu</a> (<a href="solutions-to-exercises.html#ref-ke2019predicting" role="doc-biblioref">2019</a>)</span>) but will likely blossom in the near future.<br>
</li>
<li>
<strong>Technical details</strong> of machine learning tools. While we do provide some insights on specificities of some approaches (those we believe are important), the purpose of the book is not to serve as reference manual on statistical learning. We refer to <span class="citation"><a href="solutions-to-exercises.html#ref-friedman2009elements" role="doc-biblioref">Hastie, Tibshirani, and Friedman</a> (<a href="solutions-to-exercises.html#ref-friedman2009elements" role="doc-biblioref">2009</a>)</span>, <span class="citation"><a href="solutions-to-exercises.html#ref-cornuejols2011apprentissage" role="doc-biblioref">Cornuejols, Miclet, and Barra</a> (<a href="solutions-to-exercises.html#ref-cornuejols2011apprentissage" role="doc-biblioref">2018</a>)</span> (written in French), <span class="citation"><a href="solutions-to-exercises.html#ref-james2013introduction" role="doc-biblioref">James et al.</a> (<a href="solutions-to-exercises.html#ref-james2013introduction" role="doc-biblioref">2013</a>)</span> (coded in R!) and <span class="citation"><a href="solutions-to-exercises.html#ref-mohri2018foundations" role="doc-biblioref">Mohri, Rostamizadeh, and Talwalkar</a> (<a href="solutions-to-exercises.html#ref-mohri2018foundations" role="doc-biblioref">2018</a>)</span> for a general treatment on the subject.<a class="footnote-ref" tabindex="0" data-toggle="popover" data-content='&lt;p&gt;For a list of online resources, we recommend the curated page &lt;a href="https://github.com/josephmisiti/awesome-machine-learning/blob/master/books.md" class="uri"&gt;https://github.com/josephmisiti/awesome-machine-learning/blob/master/books.md&lt;/a&gt;.&lt;/p&gt;'><sup>1</sup></a> Moreover, <span class="citation"><a href="solutions-to-exercises.html#ref-du2013neural" role="doc-biblioref">K.-L. Du and Swamy</a> (<a href="solutions-to-exercises.html#ref-du2013neural" role="doc-biblioref">2013</a>)</span> and <span class="citation"><a href="solutions-to-exercises.html#ref-goodfellow2016deep" role="doc-biblioref">Goodfellow et al.</a> (<a href="solutions-to-exercises.html#ref-goodfellow2016deep" role="doc-biblioref">2016</a>)</span> are solid monographs on neural networks particularly and <span class="citation"><a href="solutions-to-exercises.html#ref-sutton2018reinforcement" role="doc-biblioref">Sutton and Barto</a> (<a href="solutions-to-exercises.html#ref-sutton2018reinforcement" role="doc-biblioref">2018</a>)</span> provide a self-contained and comprehensive tour in reinforcement learning.<br>
</li>
<li>Finally, the book does not cover methods of <strong>natural language processing</strong> (NLP) that can be used to evaluate sentiment which can in turn be translated into investment decisions. This topic has nonetheless been trending lately and we refer to <span class="citation"><a href="solutions-to-exercises.html#ref-loughran2016textual" role="doc-biblioref">Loughran and McDonald</a> (<a href="solutions-to-exercises.html#ref-loughran2016textual" role="doc-biblioref">2016</a>)</span>, <span class="citation"><a href="solutions-to-exercises.html#ref-cong2019analyzing" role="doc-biblioref">Cong, Liang, and Zhang</a> (<a href="solutions-to-exercises.html#ref-cong2019analyzing" role="doc-biblioref">2019a</a>)</span>, <span class="citation"><a href="solutions-to-exercises.html#ref-cong2019textual" role="doc-biblioref">Cong, Liang, and Zhang</a> (<a href="solutions-to-exercises.html#ref-cong2019textual" role="doc-biblioref">2019b</a>)</span> and <span class="citation"><a href="solutions-to-exercises.html#ref-gentzkow2019text" role="doc-biblioref">Gentzkow, Kelly, and Taddy</a> (<a href="solutions-to-exercises.html#ref-gentzkow2019text" role="doc-biblioref">2019</a>)</span> for recent advances on the matter.</li>
</ul>
</div>
<div id="the-targeted-audience" class="section level2 unnumbered">
<h2>The targeted audience<a class="anchor" aria-label="anchor" href="#the-targeted-audience"><i class="fas fa-link"></i></a>
<a class="anchor" aria-label="anchor" href="#the-targeted-audience"><i class="fas fa-link"></i></a>
<a class="anchor" aria-label="anchor" href="#the-targeted-audience"><i class="fas fa-link"></i></a>
</h2>
<p>Who should read this book? This book is intended for two types of audiences. First, <strong>postgraduate students</strong> who wish to pursue their studies in quantitative finance with a view towards investment and asset management. The second target groups are <strong>professionals from the money management industry</strong> who either seek to pivot towards allocation methods that are based on machine learning or are simply interested in these new tools and want to upgrade their set of competences. To a lesser extent, the book can serve <strong>scholars or researchers</strong> who need a manual with a broad spectrum of references both on recent asset pricing issues and on machine learning algorithms applied to money management. While the book covers mostly common methods, it also shows how to implement more exotic models, like causal graphs (Chapter <a href="causality.html#causality">14</a>), Bayesian additive trees (Chapter <a href="bayes.html#bayes">9</a>), and hybrid autoencoders (Chapter <a href="NN.html#NN">7</a>).</p>
<p>The book assumes basic knowledge in <strong>algebra</strong> (matrix manipulation), <strong>analysis</strong> (function differentiation, gradients), <strong>optimization</strong> (first and second order conditions, dual forms), and <strong>statistics</strong> (distributions, moments, tests, simple estimation method like maximum likelihood). A minimal <strong>financial culture</strong> is also required: simple notions like stocks, accounting quantities (e.g., book value) will not be defined in this book. Lastly, all examples and illustrations are coded in R. A minimal culture of the language is sufficient to understand the code snippets which rely heavily on the most common functions of the tidyverse (<span class="citation"><a href="solutions-to-exercises.html#ref-wickham2019welcome" role="doc-biblioref">Wickham et al.</a> (<a href="solutions-to-exercises.html#ref-wickham2019welcome" role="doc-biblioref">2019</a>)</span>, www.tidyverse.org), and piping (<span class="citation"><a href="solutions-to-exercises.html#ref-bache2014magrittr" role="doc-biblioref">Bache and Wickham</a> (<a href="solutions-to-exercises.html#ref-bache2014magrittr" role="doc-biblioref">2014</a>)</span>, <span class="citation"><a href="solutions-to-exercises.html#ref-mailund2019pipelines" role="doc-biblioref">Mailund</a> (<a href="solutions-to-exercises.html#ref-mailund2019pipelines" role="doc-biblioref">2019</a>)</span>).</p>
</div>
<div id="how-this-book-is-structured" class="section level2 unnumbered">
<h2>How this book is structured<a class="anchor" aria-label="anchor" href="#how-this-book-is-structured"><i class="fas fa-link"></i></a>
<a class="anchor" aria-label="anchor" href="#how-this-book-is-structured"><i class="fas fa-link"></i></a>
<a class="anchor" aria-label="anchor" href="#how-this-book-is-structured"><i class="fas fa-link"></i></a>
</h2>
<p>The book is divided into four parts.</p>
<p>Part I gathers preparatory material and starts with notations and data presentation (Chapter <a href="notdata.html#notdata">1</a>), followed by introductory remarks (Chapter <a href="intro.html#intro">2</a>). Chapter <a href="factor.html#factor">3</a> outlines the economic foundations (theoretical and empirical) of factor investing and briefly sums up the dedicated recent literature. Chapter <a href="Data.html#Data">4</a> deals with data preparation. It rapidly recalls the basic tips and warns about some major issues.</p>
<p>Part II of the book is dedicated to predictive algorithms in supervised learning. Those are the most common tools that are used to forecast financial quantities (returns, volatilities, Sharpe ratios, etc.). They range from penalized regressions (Chapter <a href="lasso.html#lasso">5</a>), to tree methods (Chapter <a href="trees.html#trees">6</a>), encompassing neural networks (Chapter <a href="NN.html#NN">7</a>), support vector machines (Chapter <a href="svm.html#svm">8</a>) and Bayesian approaches (Chapter <a href="bayes.html#bayes">9</a>).</p>
<p>The next portion of the book bridges the gap between these tools and their applications in finance. Chapter <a href="valtune.html#valtune">10</a> details how to assess and improve the ML engines defined beforehand. Chapter <a href="ensemble.html#ensemble">11</a> explains how models can be combined and often why that may not be a good idea. Finally, one of the most important chapters (Chapter <a href="backtest.html#backtest">12</a>) reviews the critical steps of portfolio backtesting and mentions the frequent mistakes that are often encountered at this stage.</p>
<p>The end of the book covers a range of advanced topics connected to machine learning more specifically. The first one is <strong>interpretability</strong>. ML models are often considered to be black boxes and this raises trust issues: how and why should one trust ML-based predictions? Chapter <a href="interp.html#interp">13</a> is intended to present methods that help understand what is happening under the hood. Chapter <a href="causality.html#causality">14</a> is focused on <strong>causality</strong>, which is both a much more powerful concept than correlation and also at the heart of many recent discussions in Artificial Intelligence (AI). Most ML tools rely on correlation-like patterns and it is important to underline the benefits of techniques related to causality. Finally, Chapters <a href="unsup.html#unsup">15</a> and <a href="RL.html#RL">16</a> are dedicated to non-supervised methods. The latter can be useful, but their financial applications should be wisely and cautiously motivated. <!-- Lastly, the final chapter (\@ref(NLP)) introduces standard approaches for the treatment of textual data. --></p>
</div>
<div id="companion-website" class="section level2 unnumbered">
<h2>Companion website<a class="anchor" aria-label="anchor" href="#companion-website"><i class="fas fa-link"></i></a>
<a class="anchor" aria-label="anchor" href="#companion-website"><i class="fas fa-link"></i></a>
<a class="anchor" aria-label="anchor" href="#companion-website"><i class="fas fa-link"></i></a>
</h2>
<p>This book is entirely available at <a href="http://www.mlfactor.com" class="uri">http://www.mlfactor.com</a>. It is important that not only the content of the book be accessible, but also the data and code that are used throughout the chapters. They can be found at <a href="https://github.com/shokru/mlfactor.github.io/tree/master/material" class="uri">https://github.com/shokru/mlfactor.github.io/tree/master/material</a>. The online version of the book will be updated beyond the publication of the printed version.</p>
</div>
<div id="why-r" class="section level2 unnumbered">
<h2>Why R?<a class="anchor" aria-label="anchor" href="#why-r"><i class="fas fa-link"></i></a>
<a class="anchor" aria-label="anchor" href="#why-r"><i class="fas fa-link"></i></a>
<a class="anchor" aria-label="anchor" href="#why-r"><i class="fas fa-link"></i></a>
</h2>
<p>The supremacy of Python as <em>the</em> dominant ML programming language is a widespread belief. This is because almost all applications of deep learning (which is as of 2020 one of the most fashionable branches of ML) are coded in Python via Tensorflow or Pytorch.
The fact is that <strong>R</strong> has a <strong>lot</strong> to offer as well. First of all, let us not forget that one of the most influencial textbooks in ML (<span class="citation"><a href="solutions-to-exercises.html#ref-friedman2009elements" role="doc-biblioref">Hastie, Tibshirani, and Friedman</a> (<a href="solutions-to-exercises.html#ref-friedman2009elements" role="doc-biblioref">2009</a>)</span>) is written by statisticians who code in R. Moreover, many statistics-orientated algorithms (e.g., BARTs in Section <a href="bayes.html#BART">9.5</a>) are primarily coded in R and not always in Python. The R offering in Bayesian packages in general (<a href="https://cran.r-project.org/web/views/Bayesian.html" class="uri">https://cran.r-project.org/web/views/Bayesian.html</a>) and in Bayesian learning in particular is probably unmatched.</p>
<p>There are currently several ML frameworks available in R.</p>
<ul>
<li>
<strong>caret</strong>: <a href="https://topepo.github.io/caret/index.html" class="uri">https://topepo.github.io/caret/index.html</a>, a compilation of more than 200 ML models;<br>
</li>
<li>
<strong>tidymodels</strong>: <a href="https://github.com/tidymodels" class="uri">https://github.com/tidymodels</a>, a recent collection of packages for ML workflow (developed by Max Kuhn at RStudio, which is a token of high quality material!);<br>
</li>
<li>
<strong>rtemis</strong>: <a href="https://rtemis.netlify.com" class="uri">https://rtemis.netlify.com</a>, a general purpose package for ML and visualization;<br>
</li>
<li>
<strong>mlr3</strong>: <a href="https://mlr3.mlr-org.com/index.html" class="uri">https://mlr3.mlr-org.com/index.html</a>, also a simple framework for ML models;<br>
</li>
<li>
<strong>h2o</strong>: <a href="https://github.com/h2oai/h2o-3/tree/master/h2o-r" class="uri">https://github.com/h2oai/h2o-3/tree/master/h2o-r</a>, a large set of tools provided by h2o (coded in Java);<br>
</li>
<li>
<strong>Open ML</strong>: <a href="https://github.com/openml/openml-r" class="uri">https://github.com/openml/openml-r</a>, the R version of the OpenML (www.openml.org) community.</li>
</ul>
<p>Moreover, via the <em>reticulate</em> package, it is possible (but not always easy) to benefit from Python tools as well. The most prominent example is the adaptation of the <em>tensorflow</em> and <em>keras</em> libraries to R. Thus, some very advanced Python material is readily available to R users. This is also true for other resources, like Stanford’s CoreNLP library (in Java) which was adapted to R in the package <em>coreNLP</em> (which we will not use in this book).</p>
</div>
Nevertheless, the Python version of the book can be found in <a href="https//www.mlfactor.com/python.html">Chapter 18</a>.  
<div id="coding-instructions" class="section level2 unnumbered">
<h2>Coding instructions<a class="anchor" aria-label="anchor" href="#coding-instructions"><i class="fas fa-link"></i></a>
<a class="anchor" aria-label="anchor" href="#coding-instructions"><i class="fas fa-link"></i></a>
<a class="anchor" aria-label="anchor" href="#coding-instructions"><i class="fas fa-link"></i></a>
</h2>
<p>One of the purposes of the book is to propose a large-scale tutorial of ML applications in financial predictions and portfolio selection. Thus, one keyword is <strong>REPRODUCIBILITY</strong>! In order to duplicate our results (up to possible randomness in some learning algorithms), you will need running versions of R and RStudio on your computer. The best books to learn R are also often freely available online. A short list can be found here <a href="https://rstudio.com/resources/books/" class="uri">https://rstudio.com/resources/books/</a>. The monograph <em>R for Data Science</em> is probably the most crucial.</p>
<p>In terms of coding requirements, we rely heavily on the <strong>tidyverse</strong>, which is a collection of <strong>packages</strong> (or libraries). The three packages we use most are <strong>dplyr</strong> which implements simple data manipulations (filter, select, arrange), <strong>tidyr</strong> which formats data in a tidy fashion, and <strong>ggplot</strong>, for graphical outputs.</p>
<p>A list of the packages we use can be found in Table <a href="preface.html#tab:packages">0.1</a> below. Packages with a star <span class="math inline">\(*\)</span> need to be installed via <em>bioconductor</em>.<a class="footnote-ref" tabindex="0" data-toggle="popover" data-content='&lt;p&gt;One example: &lt;a href="https://www.bioconductor.org/packages/release/bioc/html/Rgraphviz.html" class="uri"&gt;https://www.bioconductor.org/packages/release/bioc/html/Rgraphviz.html&lt;/a&gt;&lt;/p&gt;'><sup>2</sup></a> Packages with a plus <span class="math inline">\(^+\)</span> need to be installed <strong>manually</strong>.<a class="footnote-ref" tabindex="0" data-toggle="popover" data-content="&lt;p&gt;By copy-pasting the content of the package in the library folder. To get the address of the folder, execute the command &lt;em&gt;.libPaths()&lt;/em&gt; in the R console.&lt;/p&gt;"><sup>3</sup></a></p>
<div class="inline-table"><div class="inline-table"><div class="inline-table"><table class="table table-sm">
<caption>
<span id="tab:packages">TABLE 0.1: </span> List of all packages used in the book.</caption>
<thead><tr class="header">
<th align="left"><em>Package</em></th>
<th align="left">Purpose</th>
<th align="center">Chapter(s)</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left"><em>BART</em></td>
<td align="left">Bayesian additive trees</td>
<td align="center">10</td>
</tr>
<tr class="even">
<td align="left"><em>broom</em></td>
<td align="left">Tidy regression output</td>
<td align="center">5</td>
</tr>
<tr class="odd">
<td align="left">
<em>CAM</em><span class="math inline">\(^+\)</span>
</td>
<td align="left">Causal Additive Models</td>
<td align="center">15</td>
</tr>
<tr class="even">
<td align="left"><em>caTools</em></td>
<td align="left">AUC curves</td>
<td align="center">11</td>
</tr>
<tr class="odd">
<td align="left"><em>CausalImpact</em></td>
<td align="left">Causal inference with structural time series</td>
<td align="center">15</td>
</tr>
<tr class="even">
<td align="left"><em>cowplot</em></td>
<td align="left">Stacking plots</td>
<td align="center">4 &amp; 13</td>
</tr>
<tr class="odd">
<td align="left"><em>breakDown</em></td>
<td align="left">Breakdown interpretability</td>
<td align="center">14</td>
</tr>
<tr class="even">
<td align="left"><em>dummies</em></td>
<td align="left">One-hot encoding</td>
<td align="center">8</td>
</tr>
<tr class="odd">
<td align="left"><em>e1071</em></td>
<td align="left">Support Vector Machines</td>
<td align="center">9</td>
</tr>
<tr class="even">
<td align="left"><em>factoextra</em></td>
<td align="left">PCA visualization</td>
<td align="center">16</td>
</tr>
<tr class="odd">
<td align="left"><em>fastAdaboost</em></td>
<td align="left">Boosted trees</td>
<td align="center">7</td>
</tr>
<tr class="even">
<td align="left"><em>forecast</em></td>
<td align="left">Autocorrelation function</td>
<td align="center">4</td>
</tr>
<tr class="odd">
<td align="left"><em>FNN</em></td>
<td align="left">Nearest Neighbors detection</td>
<td align="center">16</td>
</tr>
<tr class="even">
<td align="left"><em>ggpubr</em></td>
<td align="left">Combining plots</td>
<td align="center">11</td>
</tr>
<tr class="odd">
<td align="left"><em>glmnet</em></td>
<td align="left">Penalized regressions</td>
<td align="center">6</td>
</tr>
<tr class="even">
<td align="left"><em>iml</em></td>
<td align="left">Interpretability tools</td>
<td align="center">14</td>
</tr>
<tr class="odd">
<td align="left"><em>keras</em></td>
<td align="left">Neural networks</td>
<td align="center">8</td>
</tr>
<tr class="even">
<td align="left"><em>lime</em></td>
<td align="left">Interpretability</td>
<td align="center">14</td>
</tr>
<tr class="odd">
<td align="left"><em>lmtest</em></td>
<td align="left">Granger causality</td>
<td align="center">15</td>
</tr>
<tr class="even">
<td align="left"><em>lubridate</em></td>
<td align="left">Handling dates</td>
<td align="center">All (or many)</td>
</tr>
<tr class="odd">
<td align="left"><em>naivebayes</em></td>
<td align="left">Naive Bayes classifier</td>
<td align="center">10</td>
</tr>
<tr class="even">
<td align="left"><em>pcalg</em></td>
<td align="left">Causal graphs</td>
<td align="center">15</td>
</tr>
<tr class="odd">
<td align="left"><em>quadprog</em></td>
<td align="left">Quadratic programming</td>
<td align="center">12</td>
</tr>
<tr class="even">
<td align="left"><em>quantmod</em></td>
<td align="left">Data extraction</td>
<td align="center">4, 12</td>
</tr>
<tr class="odd">
<td align="left"><em>randomForest</em></td>
<td align="left">Random forests</td>
<td align="center">7</td>
</tr>
<tr class="even">
<td align="left"><em>rBayesianOptimization</em></td>
<td align="left">Bayesian hyperparameter tuning</td>
<td align="center">11</td>
</tr>
<tr class="odd">
<td align="left"><em>ReinforcementLearning</em></td>
<td align="left">Reinforcement Learning</td>
<td align="center">17</td>
</tr>
<tr class="even">
<td align="left">
<em>Rgraphviz</em><span class="math inline">\(^*\)</span>
</td>
<td align="left">Causal graphs</td>
<td align="center">15</td>
</tr>
<tr class="odd">
<td align="left">
<em>rpart</em> and <em>rpart.plot</em>
</td>
<td align="left">Simple decision trees</td>
<td align="center">7</td>
</tr>
<tr class="even">
<td align="left"><em>spBayes</em></td>
<td align="left">Bayesian linear regression</td>
<td align="center">10</td>
</tr>
<tr class="odd">
<td align="left"><em>tidyverse</em></td>
<td align="left">Environment for data science, data wrangling</td>
<td align="center">All</td>
</tr>
<tr class="even">
<td align="left"><em>xgboost</em></td>
<td align="left">Boosted trees</td>
<td align="center">7</td>
</tr>
<tr class="odd">
<td align="left"><em>xtable</em></td>
<td align="left">Table formatting</td>
<td align="center">4</td>
</tr>
</tbody>
</table></div></div></div>
<p>Of all of these packages (or collections thereof), the <strong>tidyverse</strong> and <strong>lubridate</strong> are compulsory in almost all sections of the book. To install a new package in R, just type</p>
<p>install.packages(“name_of_the_package”)</p>
<p>in the console. Sometimes, because of function name conflicts (especially with the select() function), we use the syntax package::function() to make sure the function call is from the right source. The exact version of the packages used to compile the book is listed in the “<em>renv.lock</em>” file available on the book’s GitHub web page <a href="https://github.com/shokru/mlfactor.github.io" class="uri">https://github.com/shokru/mlfactor.github.io</a>. One minor comment is the following: while the functions <em>gather()</em> and <em>spread()</em> from the <em>dplyr</em> package have been superseded by <em>pivot_longer()</em> and <em>pivot_wider()</em>, we still use them because of their much more compact syntax.</p>
<p>As much as we could, we created short <strong>code chunks</strong> and commented each line whenever we felt it was useful. Comments are displayed at the end of a row and preceded with a single hastag #.</p>
<p>The book is constructed as a very big notebook, thus results are often presented below code chunks. They can be graphs or tables. Sometimes, they are simple numbers and are preceded with two hashtags ##. The example below illustrates this formatting.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R">

<span class="fl">1</span><span class="op">+</span><span class="fl">2</span> <span class="co"># Example</span></code></pre></div>
<pre><code>## [1] 3</code></pre>
<p></p>
<p>The book can be viewed as a very big tutorial. Therefore, most of the chunks depend on previously defined variables. When replicating parts of the code (via online code), please make sure that <strong>the environment includes all relevant variables</strong>. One best practice is to always start by running all code chunks from Chapter <a href="notdata.html#notdata">1</a>. For the exercises, we often resort to variables created in the corresponding chapters.</p>
</div>
<div id="acknowledgments" class="section level2 unnumbered">
<h2>Acknowledgments<a class="anchor" aria-label="anchor" href="#acknowledgments"><i class="fas fa-link"></i></a>
<a class="anchor" aria-label="anchor" href="#acknowledgments"><i class="fas fa-link"></i></a>
<a class="anchor" aria-label="anchor" href="#acknowledgments"><i class="fas fa-link"></i></a>
</h2>
<p>The core of the book was prepared for a series of lectures given by one of the authors to students of master’s degrees in finance at EMLYON Business School and at the Imperial College Business School in the Spring of 2019. We are grateful to those students who asked fruitful questions and thereby contributed to improve the content of the book.</p>
<p>We are grateful to Bertrand Tavin and Gautier Marti for their thorough screening of the book. We also thank Eric André, Aurélie Brossard, Alban Cousin, Frédérique Girod, Philippe Huber, Jean-Michel Maeso, Javier Nogales and for friendly reviews; Christophe Dervieux for his help with bookdown; Mislav Sagovac and Vu Tran for their early feedback; John Kimmel for making this happen and Jonathan Regenstein for his availability, no matter the topic. Lastly, we are grateful for the anonymous reviews collected by John, our original editor.</p>
</div>
<div id="future-developments" class="section level2 unnumbered">
<h2>Future developments<a class="anchor" aria-label="anchor" href="#future-developments"><i class="fas fa-link"></i></a>
<a class="anchor" aria-label="anchor" href="#future-developments"><i class="fas fa-link"></i></a>
<a class="anchor" aria-label="anchor" href="#future-developments"><i class="fas fa-link"></i></a>
</h2>
<p>Machine learning and factor investing are two immense research domains and the overlap between the two is also quite substantial and developing at a fast pace. The content of this book will always constitute a solid background, but it is naturally destined to obsolescence. Moreover, by construction, some subtopics and many references will have escaped our scrutiny. Our intent is to progressively improve the content of the book and update it with the latest ongoing research. We will be grateful to any comment that helps correct or update the monograph. Thank you for sending your feedback directly (via pull requests) on the book’s website which is hosted at <a href="https://github.com/shokru/mlfactor.github.io" class="uri">https://github.com/shokru/mlfactor.github.io</a>.</p>

</div>
</div>




  <div class="chapter-nav">
<div class="empty"></div>
<div class="next"><a href="notdata.html"><span class="header-section-number">1</span> Notations and data</a></div>
</div>
<div class="chapter-nav">
<div class="empty"></div>
<div class="next"><a href="notdata.html"><span class="header-section-number">1</span> Notations and data</a></div>
</div>
<div class="chapter-nav">
<div class="empty"></div>
<div class="next"><a href="notdata.html"><span class="header-section-number">1</span> Notations and data</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#preface">Preface</a></li>
<li><a class="nav-link" href="#what-this-book-is-not-about">What this book is not about</a></li>
<li><a class="nav-link" href="#the-targeted-audience">The targeted audience</a></li>
<li><a class="nav-link" href="#how-this-book-is-structured">How this book is structured</a></li>
<li><a class="nav-link" href="#companion-website">Companion website</a></li>
<li><a class="nav-link" href="#why-r">Why R?</a></li>
<li><a class="nav-link" href="#coding-instructions">Coding instructions</a></li>
<li><a class="nav-link" href="#acknowledgments">Acknowledgments</a></li>
<li><a class="nav-link" href="#future-developments">Future developments</a></li>
</ul>
<div class="book-extra">
        <ul class="list-unstyled"></ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>Machine Learning for Factor Investing</strong>" was written by Guillaume Coqueret and Tony Guida. It was last built on 2023-07-17.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer><!-- dynamically load mathjax for compatibility with self-contained --><script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>
</html>
